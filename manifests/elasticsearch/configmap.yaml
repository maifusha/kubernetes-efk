apiVersion: v1
kind: ConfigMap
metadata:
  name: elasticsearch
  labels:
    app: elasticsearch
    stack: efk
data:
  elasticsearch.yml: |
    cluster.name: efk-cluster
    node:
      name: efk-node-1
      master: true
      data: true
      ingest: true
      max_local_storage_nodes: 1
    path:
      data: /usr/share/elasticsearch/data
      logs: /usr/share/elasticsearch/log
    bootstrap.memory_lock: true
    search.remote.connect: false
    network.host: _site_
    http:
      enabled: true
      host: 0.0.0.0
      port: 9200
    transport:
      host: 0.0.0.0
      tcp:
        port: 9300
    discovery:
      type: single-node
      #zen:
      #  minimum_master_nodes: 1
      #  ping:
      #    unicast:
      #      hosts: elasticsearch.$NAMESPACE.svc
    xpack.monitoring.enabled: true
    xpack.ml.enabled: false
    xpack.watcher.enabled: false
    xpack.security.enabled: true
    xpack.security.audit.enabled: false
    xpack.security.http.ssl.enabled: false
    xpack.security.transport.ssl.enabled: false
  limits.conf: |
    # allow user 'elasticsearch' mlockall
    elasticsearch soft memlock unlimited
    elasticsearch hard memlock unlimited
